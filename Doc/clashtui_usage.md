# ClashTUI Usage

## ClashTUI config

config file path is `~/.config/clashtui/config.yaml`.

```yaml
# The following parameters correspond to the command <clash_core_path> -d <clash_cfg_dir> -f <clash_cfg_path>
basic:
  clash_config_dir: '/opt/clashtui/mihomo_config'
  clash_bin_path: '/usr/bin/mihomo'
  clash_config_path: '/opt/clashtui/mihomo_config/config.yaml'
  timeout: null                     # the timeout duration for downloading via clash_ua. `null` means no timeout. The unit is `seconds`.
service:
  clash_srv_name: 'mihomo'          # systemctl {restart | stop} <clash_srv_name>
  is_user: false                    # true: systemctl --user ...
extra:
  edit_cmd: 'alacritty -e nvim %s'          # `%s` will be replaced by the file path. If it is empty, use `xdg-open` to open the file.
  open_dir_cmd: 'alacritty -e ranger %s'
```

## Shortcuts

Press `?` to display help.

## Portable Mode

Create a folder named `data` in the directory where clashtui program resides. Then the data will be placed in `data` instead of `~/.config/clashtui`.

## Scheduled Updates with cronie

```sh
clashtui -u         # Updates all profiles in command-line mode. If the profile has proxy-providers, they will also be updated.
```

Thus, you can use cronie to schedule updates:

```sh
# crontab -e
0 10,14,16,22 * * * /usr/bin/env clashtui -u >> ~/cron.out 2>&1
```

For cronie usage, see [ref](https://wiki.archlinuxcn.org/wiki/Cron).

## ClashTUI File Structure

- basic_clash_config.yaml: Basic fields of mihomo configuration, which will be merged into `clash_cfg_path`.
- config.yaml: Configuration of clashtui.

## Template

It is assumed that you are already familiar with [mihomo configuration](https://wiki.metacubex.one/config/) and YAML syntax.

### Proxy-Providers Template

Purpose: Generates a proxy-provider for each Proxy-Providers in `template_proxy_providers`.

For example:

```yaml
proxy-anchor:
  - delay_test: &pa_dt {url: https://www.gstatic.com/generate_204, interval: 300}
  - proxy_provider: &pa_pp {interval: 3600, health-check: {enable: true, url: https://www.gstatic.com/generate_204, interval: 300}}

proxy-providers:
  provider:
    tpl_param:
    type: http    # The type field must be placed here, not within pa_pp. This is because clashtui detects whether it is a network resource based on this field.
    <<: *pa_pp
```

### Proxy-Groups Template

Purpose: Generates a Proxy-Group for each proxy-provider produced by the Proxy-Providers template.

```yaml
proxy-groups:
  - name: "Select"
    tpl_param:
      providers: ["provider"]
    type: select

  - name: "Auto"
    tpl_param:
      providers: ["provider"]
    type: url-test
    <<: *pa_dt
```

### Using Proxy-Groups Template

To use each proxy-group generated by the Proxy-Group template, enclose the Proxy-Group template name within `<>`.

For example:

```yaml
proxy-groups:
  - name: "Entry"
    type: select
    proxies:
      - <Auto>
      - <Select>
```

---

The latest templates can be found [here](https://github.com/JohanChane/clashtui/tree/main/Example/templates).
